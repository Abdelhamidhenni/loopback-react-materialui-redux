# My Application

The project is generated by [LoopBack](http://loopback.io).

## Table of Contents

- [TL;DR](#tldr)
- [개발환경](#개발환경)
- [로그인](#로그인)
- [사용자정의](#사용자정의)
- [Material UI](#Material-UI)

## tldr

#### 처음사용하는 경우

REST API 서버용 terminal 하나와 frontend 개발을 위한 static contents 서비스용 terminal 하나, 총 2개의 terminal에서 작업

```
$ git clone git@github.com:discrete/loopback-react-materialui-redux.git project_dir
$ cd project_dir
$ yarn install
$ docker-compose up -d
$ yarn start
```
다른 terminal을 하나 더 열어서 frontend 개발용 webpack dev server를 시작한다.
```
$ cd clinet_src
$ yarn install
$ yarn start
```

Browser를 열고 [http://localhost:3000](http://localhost:3000)을 연다. SPA app이 열린다.
http://localhost:3001/explorer loopback REST API explorer를 볼 수 있다.

### 설치가 되어 있는 상태에서 개발을 진행할 경우
```
$ cd project_dir
$ docker-compose start
$ yarn start
```

## 개발환경

* Loopback(backend): port 3001
* React+Redux+React-Router4+Material UI+ redux form(frontend): port 3000
* mongodb(DB): port 27017

loopback의 scaffolding을 이용해서 backend app을 만들고, client_src folder를 추가하고 그 안에서 create-react-app을 이용해서 frontend app을 만든다.

docker-compose를 통해서 mongodb를 container안에서 가동시키기 때문에 시작시에 별도로 준비할 필요없이 docker-compose up 해주면 mongodb를 가져다가 돌리기 시작한다.

Note: 아쉽게도 Windows에서는 Mongodb가 docker로 돌아가지 않는다. Mongodb가 file의 lock을 독점할 수 없는 형태로 Hyper-V와 Host machine이 volume을 공유하기 때문이다. Windows에서는 docker를 사용하지 말고 cloud에서 제공하는 Mongodb as a service하나를 골라서 사용하면 좋다. 운영시에는 문제가 되지 않는다. [MongoDB Atlas](#https://cloud.mongodb.com)


## 로그인

SPA에서 로그인을 유지하는 방법에는 아래와 같이 3가지가 있다.
loopback은 API 지향적이지만, passportjs를 붙여 놓은 [loopback-component-passport](https://loopback.io/doc/en/lb3/Third-party-login-using-Passport.html)가 cookie-based authentication을 사용하도록 강제한다.

* Session-based authentication
* Cookie-based authentication
* Token-based authentication

현재의 구현은 development와 production에서 똑같은 UX를 가지고 개발하기 위해서 development는 create-react-app에서 제공하는 Webpack-dev server의 proxy를 이용해서 /auth를 proxy로 요청한다.

## 사용자정의

운영하고자하는 서비스에서 필요한 사용자 정보를 저장하는 방법은..

## Material UI

React로 뭔가 차별화된 UI를 만들어 간다면 create-react-app이 만들어준 그 상태에서 시작하면 된다. 기본적으로 redux는 있어야 변경 되는 data를 관리할 수 있는 point를 갖게되니까 redux를 붙이고, SPA를 page단위로는 나눠서 작업을 해야 편하니 react-router 써주자, 이왕이면 4 새로 나왔으니까.. 써보니 좋다. 이런거 없이 그냥 SPA 만드는 사람들 존경스럽다. 그 많은 것들을 다 머리에 꾀고

이렇게 붙였는데도 돌려보면 할 수 있는게 `<h2>Root</h2>`, `<h2>Sign In</h2>` 정도라면 힘빠진다. [Material UI](https://material.io/)가 반응형이고 spec이 잘 정의되어 있고, 고객들도 특별히 원하는 디자인이 있지 않을땐 거부감이 없기때문에 Material UI를 사용해 본다.

